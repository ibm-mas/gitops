---
apiVersion: core.mas.ibm.com/v1
kind: Suite
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "0"
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
{{- if .Values.mas_annotations }}
{{ .Values.mas_annotations | toYaml | indent 4 }}
{{- end }}
  labels:
    mas.ibm.com/instanceId: "{{ .Values.mas_instance_id }}" 
{{- if .Values.mas_labels }}
{{ .Values.mas_labels | toYaml | indent 4 }}
{{- end }}
  name: "{{ .Values.mas_instance_id }}"  
spec:
  domain: "{{ .Values.domain }}"
  certManagerNamespace: ibm-common-services
{{- if and .Values.dns_provider (eq .Values.mas_manual_cert_mgmt false) }}
  certificateIssuer:
    duration: 8760h0m0s
    name: "{{ .Values.mas_instance_id }}-{{ .Values.dns_provider }}-le-prod" 
    renewBefore: 720h0m0s
{{ end }}
  license:
    accept: true
  settings:
    manualCertMgmt: {{ .Values.mas_manual_cert_mgmt | default false }}
    icr:
      cp: "{{ .Values.icr_cp }}"
      cpopen: "{{ .Values.icr_cp_open }}"
{{- if .Values.mas_image_tags }}
    imageTags: 
{{ .Values.mas_image_tags | toYaml | indent 6 }}
{{ end }}
