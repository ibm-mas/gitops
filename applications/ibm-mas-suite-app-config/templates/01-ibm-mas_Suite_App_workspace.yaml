---
apiVersion: {{ .Values.mas_app_ws_apiversion }}
kind: {{ .Values.mas_app_ws_kind }}
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "0"
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
  name: "{{ .Values.mas_instance_id }}-{{ .Values.mas_workspace_id }}"
  namespace: {{ .Values.mas_app_namespace }}
  labels:
    mas.ibm.com/instanceId: {{ .Values.mas_instance_id }}
    mas.ibm.com/workspaceId: {{ .Values.mas_workspace_id }}
    mas.ibm.com/applicationId: {{ .Values.mas_app_id }}
spec:
{{- if eq .Values.mas_app_id "manage" }}
  bindings:
  {{ .Values.manage_bindings | toYaml  | indent 4 }}
  components: 
  {{ .Values.manage_mas_appws_components | toYaml  | indent 4 }}
  settings:
    deployment:
      persistentVolumes: {{ .Values.mas_app_settings_persistent_volumes }}
      {{- if eq .Values.mas_app_settings_server_bundles_type "dev" }}
      serverBundles:
      {{ .Values.mas_app_settings_server_bundles_dev | toYaml  | indent 8 }}
      {{- else if eq .Values.mas_app_settings_server_bundles_type "small" }}
      serverBundles:
      {{ .Values.mas_app_settings_server_bundles_small | toYaml  | indent 8 }}
      {{- else if eq .Values.mas_app_settings_server_bundles_type "jms" }}
      serverBundles:
      {{ .Values.mas_app_settings_server_bundles_jms | toYaml  | indent 8 }}
      {{- else if eq .Values.mas_app_settings_server_bundles_type "snojms" }}
      serverBundles:
      {{ .Values.mas_app_settings_server_bundles_snojms | toYaml  | indent 8 }}
      {{- end }}
      defaultJMS: {{ .Values.mas_app_settings_default_jms }}
    languages:
      baseLang: {{ .Values.mas_app_settings_base_language  }}
      secondaryLangs: {{ .Values.mas_app_settings_secondary_languages }}
    aio:
      install: {{ .Values.mas_app_settings_aio_flag   }}
    db:
      dbSchema: {{ .Values.mas_app_settings_db2_schema }}
      maxinst:
        demodata: {{ .Values.mas_app_settings_demodata }}
        db2Vargraphic: true
        tableSpace: {{ .Values.mas_app_settings_tablespace }}
        indexSpace: {{ .Values.mas_app_settings_indexspace }}
        bypassUpgradeVersionCheck: false
    customizationList: {{  .Values.mas_app_settings_customization_list }}
{{- end }}

