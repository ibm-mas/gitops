{{- if or .Values.allow_list .Values.additional_vpn .Values.enhanced_dr .Values.extensions .Values.replica_db .Values.cluster_nonshared .Values.application_configuration .Values.additional_resources.install }}
---
# Permit outbound communication by the Job pods
# (Needed to communicate with the K8S HTTP API)
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: "{{ .Values.instance_id }}-allow-oc-addon-cleanup-job"
  namespace: mas-{{ .Values.instance_id }}-core
  annotations:
    argocd.argoproj.io/sync-wave: "558"
{{- if .Values.custom_labels }}
  labels:
{{ .Values.custom_labels | toYaml | indent 4 }}
{{- end }}
spec:
  podSelector:
    matchLabels:
      app: addon-cleanup-job
  egress:
    - {}
  policyTypes:
    - Egress
{{- end }}
