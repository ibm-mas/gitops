<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://pages.github.com/ibm-mas/gitops/reference/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Reference - MAS GitOps</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Reference";
        var mkdocs_page_input_path = "reference.md";
        var mkdocs_page_url = "/ibm-mas/gitops/reference/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> MAS GitOps
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../sourcerepo/">Source Repository</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../configrepo/">Config Repository</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../configtoinstances/">Mapping Config to MAS Instances</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../orchestration/">Deployment Orchestration</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#account-root-application-manifest">Account Root Application Manifest</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#template">Template</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#source-repo-url">&lt;source-repo-url&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#source-repo-revision">&lt;source-repo-revision&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#config-repo">&lt;config-repo&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#config-repo-revision">&lt;config-repo-revision&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#account-id">&lt;account-id&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#argo-namespace">&lt;argo-namespace&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#argo-project-rootapps">&lt;argo-project-rootapps&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#argo-project-apps">&lt;argo-project-apps&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#avp-name">&lt;avp-name&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#avp-secret">&lt;avp-secret&gt;</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#avp-values_varname">&lt;avp-values_varname&gt;</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../limitations/">Known Limitations</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">MAS GitOps</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Reference</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ibm-mas/gitops/blob/demo2/docs/reference.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link"></a></h1>
<h2 id="account-root-application-manifest">Account Root Application Manifest<a class="headerlink" href="#account-root-application-manifest" title="Permanent link"></a></h2>
<h3 id="template">Template<a class="headerlink" href="#template" title="Permanent link"></a></h3>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: root.&lt;account-id&gt;
  namespace: &lt;argoapp-namespace&gt;
spec:
  destination:
    namespace: &lt;argoapp-namespace&gt;
    server: 'https://kubernetes.default.svc'
  project: &quot;&lt;argo-project-rootapps&gt;&quot;
  source:
    path: root-applications/ibm-mas-account-root
    repoURL: &lt;source-repo-url&gt;
    targetRevision: &quot;&lt;source-repo-revision&gt;&quot;
    helm:
      values: |
          account:
            id: &quot;&lt;account-id&gt;

          generator:
            repo_url: &quot;&lt;config-repo&gt;&quot;
            revision: &quot;&lt;config-repo-revision&gt;&quot;

          source:
            repo_url: &quot;&lt;source-repo-url&gt;&quot;
            revision: &quot;&lt;source-repo-revision&gt;&quot;

          argo:
            namespace: &quot;&lt;argo-namespace&gt;&quot;
            projects:
              rootapps: &quot;&lt;argo-project-rootapps&gt;
              apps: &quot;&lt;argo-project-apps&gt;&quot;

          avp:
            name: &quot;&lt;avp-name&gt;&quot;
            secret: &quot;&lt;avp-secret&gt;&quot;
            values_varname: &quot;&lt;val-values-varname&gt;&quot;

  syncPolicy:
    syncOptions:
      - CreateNamespace=false
</code></pre>
<h3 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link"></a></h3>
<h4 id="source-repo-url"><code>&lt;source-repo-url&gt;</code><a class="headerlink" href="#source-repo-url" title="Permanent link"></a></h4>
<p>The url of the source helm charts and argo apps. e.g. https://github.com/ibm-mas/gitops.</p>
<h4 id="source-repo-revision"><code>&lt;source-repo-revision&gt;</code><a class="headerlink" href="#source-repo-revision" title="Permanent link"></a></h4>
<p>The branch of <code>&lt;source-repo-url&gt;</code> to source charts from, e.g. <code>master</code>.</p>
<h4 id="config-repo"><code>&lt;config-repo&gt;</code><a class="headerlink" href="#config-repo" title="Permanent link"></a></h4>
<p>The github repo to source cluster/instance configuration from, e.g. <code>git@github.ibm.com:maximoappsuite/gitops-envs.git</code>.</p>
<h4 id="config-repo-revision"><code>&lt;config-repo-revision&gt;</code><a class="headerlink" href="#config-repo-revision" title="Permanent link"></a></h4>
<p>The revision of <code>&lt;config-repo&gt;</code> to source cluster/instance configuration from, e.g. <code>master</code>.</p>
<h4 id="account-id"><code>&lt;account-id&gt;</code><a class="headerlink" href="#account-id" title="Permanent link"></a></h4>
<blockquote>
<p>The ID of the account this root application manages. This also determines the root folder in <code>&lt;config-repo&gt;</code>:<code>&lt;config-repo-revision</code> to source cluster/instance configuration from, e.g. <code>aws-dev</code>.</p>
</blockquote>
<h4 id="argo-namespace"><code>&lt;argo-namespace&gt;</code><a class="headerlink" href="#argo-namespace" title="Permanent link"></a></h4>
<p>The namespace on cluster running ArgoCD. E.g. <code>openshift-gitops</code> (internal clusters), <code>argocd-worker</code> (MCSP). This determines where Application and ApplicationSet resources will be created. It will also be used to annotate namespaces created by our charts with <a href="https://argocd-operator.readthedocs.io/en/stable/usage/deploy-to-different-namespaces/">argocd.argoproj.io/managed-by</a>.</p>
<h4 id="argo-project-rootapps"><code>&lt;argo-project-rootapps&gt;</code><a class="headerlink" href="#argo-project-rootapps" title="Permanent link"></a></h4>
<p>The ArgoCD project in which to create root applications (including this Application and the root applications that it generates). The project must be configured to permit creation of <code>argoproj.io.Application</code> and <code>argoproj.io.ApplicationSet</code> resources in the <code>&lt;argoapp-namespace&gt;</code> of the cluster in which ArgoCD is running (i.e. <code>https://kubernetes.default.svc</code>). In fvtsaas, this project is currently <code>mas</code>. In the MCSP dev worker, it is <code>mas-argoproj-resources</code>.</p>
<h4 id="argo-project-apps"><code>&lt;argo-project-apps&gt;</code><a class="headerlink" href="#argo-project-apps" title="Permanent link"></a></h4>
<p>The ArgoCD project in which to create the applications that deploy MAS resources (and their dependencies) to external MAS clusters. The project must be configured to permit creation of any resource in any namespace of all external MAS clusters targeted by this account. In fvtsaas, this project is currently <code>mas</code>. In the MCSP dev worker, it is also <code>mas</code>.</p>
<h4 id="avp-name"><code>&lt;avp-name&gt;</code><a class="headerlink" href="#avp-name" title="Permanent link"></a></h4>
<p>The name assigned to the ArgoCD Vault Plugin used for retrieving secrets. Defaults to <code>argocd-vault-plugin-helm</code>. In MCSP, this must be <code>argocd-vault-plugin-helm-inline</code>.</p>
<h4 id="avp-secret"><code>&lt;avp-secret&gt;</code><a class="headerlink" href="#avp-secret" title="Permanent link"></a></h4>
<p>The name of the k8s secret containing the credentials for accessing the vault that AVP is linked with. Defaults to the empty string, which implies that these credentials have been configured already in the cluster.</p>
<h4 id="avp-values_varname"><code>&lt;avp-values_varname&gt;</code><a class="headerlink" href="#avp-values_varname" title="Permanent link"></a></h4>
<p>The name of the environment variable used to pass values inline to AVP. Defaults to <code>HELM_VALUES</code>. In MCSP this must be <code>HELM_INVLINE_VALUES</code></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/gitops" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../orchestration/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../limitations/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
      <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
